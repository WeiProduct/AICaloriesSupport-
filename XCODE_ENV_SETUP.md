# Xcode环境变量设置详细步骤

## 步骤1：打开Scheme编辑器

1. 在Xcode中，点击顶部工具栏的 **"AI卡路里"** 按钮（在停止按钮旁边）
2. 从下拉菜单中选择 **"Edit Scheme..."**

或者使用快捷键：**Cmd + <**

## 步骤2：添加环境变量

1. 在弹出的窗口中：
   - 左侧选择 **"Run"**
   - 顶部选择 **"Arguments"** 标签
   
2. 在 **"Environment Variables"** 部分：
   - 点击左下角的 **"+"** 按钮
   - 添加以下变量：
   
   | Name | Value |
   |------|-------|
   | OPENAI_API_KEY | sk-你的OpenAI密钥 |

3. 确保变量前的复选框是勾选状态 ✓

4. 点击 **"Close"** 关闭窗口

## 步骤3：验证设置

1. **重新运行应用**（Cmd + R）
2. 进入 **设置 → 开发者选项**
3. **关闭"使用代理模式"**（确保开关是关闭状态）
4. 返回主界面，点击 **"拍照记录食物"**
5. 选择一张食物照片进行测试

## 常见问题

### Q: 环境变量设置了但还是报错？
A: 请确保：
- 变量名拼写正确：`OPENAI_API_KEY`（全大写）
- API密钥格式正确（以 `sk-` 开头）
- 重新运行了应用
- 关闭了代理模式

### Q: 在哪里获取OpenAI API密钥？
A: 访问 https://platform.openai.com/api-keys 创建新密钥

### Q: 能否在代码中直接写密钥？
A: 强烈不推荐！这会导致：
- 密钥泄露风险
- 代码提交时暴露密钥
- 违反安全最佳实践

## 代理模式 vs 直连模式

| 模式 | 适用场景 | 优点 | 缺点 |
|------|---------|------|------|
| 直连模式 | 开发调试 | 快速、无需部署 | 需要本地配置密钥 |
| 代理模式 | 生产环境 | 安全、密钥在服务器 | 需要部署代理服务器 |

## 安全提醒

⚠️ **重要**：
- 环境变量仅存在于你的本地Xcode中
- 不会被提交到Git
- 不会包含在编译后的应用中
- 生产发布前必须切换到代理模式